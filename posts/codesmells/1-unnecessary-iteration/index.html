<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Unnecessary Iteration | Code Smells for Machine Learning Applications</title><meta name=keywords content="generic,data cleaning,efficiency"><meta name=description content="Avoid unnecessary iterations. Use vectorized solutions instead of loops."><meta name=author content><link rel=canonical href=https://hynn01.github.io/ml-smells/posts/codesmells/1-unnecessary-iteration/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/ml-smells/assets/css/stylesheet.min.7562f2f4c1c0f34ea6add27a32f5b2afe3d35c8ca1c2a71e389ffe4cbae1859b.css integrity="sha256-dWLy9MHA806mrdJ6MvWyr+PTXIyhwqceOJ/+TLrhhZs=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/ml-smells/assets/js/highlight.min.e85ad0406048e8176e1c7661b25d5c69297ddfe41dc4124cf75ecb99a4f7b3d1.js integrity="sha256-6FrQQGBI6BduHHZhsl1caSl93+QdxBJM917LmaT3s9E=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://hynn01.github.io/ml-smells/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://hynn01.github.io/ml-smells/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://hynn01.github.io/ml-smells/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://hynn01.github.io/ml-smells/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://hynn01.github.io/ml-smells/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.101.0"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Unnecessary Iteration"><meta property="og:description" content="Avoid unnecessary iterations. Use vectorized solutions instead of loops."><meta property="og:type" content="article"><meta property="og:url" content="https://hynn01.github.io/ml-smells/posts/codesmells/1-unnecessary-iteration/"><meta property="article:section" content="posts"><meta property="og:site_name" content="Code Smells for Machine Learning Applications"><meta name=twitter:card content="summary"><meta name=twitter:title content="Unnecessary Iteration"><meta name=twitter:description content="Avoid unnecessary iterations. Use vectorized solutions instead of loops."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://hynn01.github.io/ml-smells/posts/"},{"@type":"ListItem","position":2,"name":"Code Smells","item":"https://hynn01.github.io/ml-smells/posts/codesmells/"},{"@type":"ListItem","position":3,"name":"Unnecessary Iteration","item":"https://hynn01.github.io/ml-smells/posts/codesmells/1-unnecessary-iteration/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Unnecessary Iteration","name":"Unnecessary Iteration","description":"Avoid unnecessary iterations. Use vectorized solutions instead of loops.","keywords":["generic","data cleaning","efficiency"],"articleBody":"Description Context Loops are typically time-consuming and verbose, while developers can usually use some vectorized solutions to replace the loops.\nProblem As stated in the Pandas documentation: “Iterating through pandas objects is generally slow. In many cases, iterating manually over the rows is not needed and can be avoided”. In EffectiveTensorflow github repository, it is also stated that the slicing operation with loops in TensorFlow is slow, and there is a substitute for better performance.\nSolution Machine learning applications are typically data-intensive, requiring operations on data sets rather than an individual value. Therefore, it is better to adopt a vectorized solution instead of iterating over data. In this way, the program runs faster and code complexity is reduced, resulting in more efficient and less error-prone code. Pandas’ built-in methods (e.g., join, groupby) are vectorized. It is therefore recommended to use Pandas built-in methods as an alternative to loops. In TensorFlow, using the tf.reduce_sum() API to perform reduction operation is much faster than combining slicing operation and loops.\nType Generic\nExisting Stage Data Cleaning\nEffect Efficiency\nExample ### Pandas import pandas as pd df = pd.DataFrame([1, 2, 3]) - result = [] - for index, row in df.iterrows(): - result.append(row[0] + 1) - result = pd.DataFrame(result) + result = df.add(1) ### TensorFlow 2 import tensorflow as tf x = tf.random.uniform([500, 10]) - z = tf.zeros([10]) - for i in range(500): - z += x[i] + z = tf.reduce_sum(x, axis=0) Source: Paper MPA Haakman. 2020. Studying the Machine Learning Lifecycle and Improving Code Quality of Machine Learning Application Grey Literature GitHub Commit https://github.com/tensorflow/models/commit/90f63a1e1653bfa17fde8260a4aa20231b269b7d Stack Overflow Documentation https://pandas.pydata.org/pandas-docs/stable/user_guide/basics.html#iteration ","wordCount":"265","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://hynn01.github.io/ml-smells/posts/codesmells/1-unnecessary-iteration/"},"publisher":{"@type":"Organization","name":"Code Smells for Machine Learning Applications","logo":{"@type":"ImageObject","url":"https://hynn01.github.io/ml-smells/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://hynn01.github.io/ml-smells/ accesskey=h title="Code Smells for Machine Learning Applications (Alt + H)">Code Smells for Machine Learning Applications</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://hynn01.github.io/ml-smells/posts/codesmells/ title="Code Smells"><span>Code Smells</span></a></li><li><a href=https://hynn01.github.io/ml-smells/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://hynn01.github.io/ml-smells/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://hynn01.github.io/ml-smells/>Home</a>&nbsp;»&nbsp;<a href=https://hynn01.github.io/ml-smells/posts/>Posts</a>&nbsp;»&nbsp;<a href=https://hynn01.github.io/ml-smells/posts/codesmells/>Code Smells</a></div><h1 class=post-title>Unnecessary Iteration</h1><div class=post-meta></div></header><div class=post-content><h3 id=description>Description<a hidden class=anchor aria-hidden=true href=#description>#</a></h3><h4 id=context>Context<a hidden class=anchor aria-hidden=true href=#context>#</a></h4><p>Loops are typically time-consuming and verbose, while developers can usually use some vectorized solutions to replace the loops.</p><h4 id=problem>Problem<a hidden class=anchor aria-hidden=true href=#problem>#</a></h4><p>As stated in the Pandas documentation: &ldquo;Iterating through pandas objects is generally slow. In many cases, iterating manually over the rows is not needed and can be avoided&rdquo;. In <code>EffectiveTensorflow</code> github repository, it is also stated that the slicing operation with loops in TensorFlow is slow, and there is a substitute for better performance.</p><h4 id=solution>Solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h4><p>Machine learning applications are typically data-intensive, requiring operations on data sets rather than an individual value. Therefore, it is better to adopt a vectorized solution instead of iterating over data. In this way, the program runs faster and code complexity is reduced, resulting in more efficient and less error-prone code. Pandas&rsquo; built-in methods (e.g., join, groupby) are vectorized. It is therefore recommended to use Pandas built-in methods as an alternative to loops. In TensorFlow, using the <code>tf.reduce_sum()</code> API to perform reduction operation is much faster than combining slicing operation and loops.</p><h3 id=type>Type<a hidden class=anchor aria-hidden=true href=#type>#</a></h3><p>Generic</p><h3 id=existing-stage>Existing Stage<a hidden class=anchor aria-hidden=true href=#existing-stage>#</a></h3><p>Data Cleaning</p><h3 id=effect>Effect<a hidden class=anchor aria-hidden=true href=#effect>#</a></h3><p>Efficiency</p><h3 id=example>Example<a hidden class=anchor aria-hidden=true href=#example>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>### Pandas
</span></span><span style=display:flex><span>import pandas as pd
</span></span><span style=display:flex><span>df = pd.DataFrame([1, 2, 3])
</span></span><span style=display:flex><span><span style=color:#f92672>- result = []
</span></span></span><span style=display:flex><span><span style=color:#f92672>- for index, row in df.iterrows():
</span></span></span><span style=display:flex><span><span style=color:#f92672>- 	result.append(row[0] + 1)
</span></span></span><span style=display:flex><span><span style=color:#f92672>- result = pd.DataFrame(result)
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+ result = df.add(1)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>
</span></span><span style=display:flex><span>### TensorFlow 2
</span></span><span style=display:flex><span>import tensorflow as tf
</span></span><span style=display:flex><span>x = tf.random.uniform([500, 10])
</span></span><span style=display:flex><span><span style=color:#f92672>- z = tf.zeros([10])
</span></span></span><span style=display:flex><span><span style=color:#f92672>- for i in range(500):
</span></span></span><span style=display:flex><span><span style=color:#f92672>-    z += x[i]
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+ z = tf.reduce_sum(x, axis=0)
</span></span></span></code></pre></div><h3 id=source>Source:<a hidden class=anchor aria-hidden=true href=#source>#</a></h3><h4 id=paper>Paper<a hidden class=anchor aria-hidden=true href=#paper>#</a></h4><ul><li>MPA Haakman. 2020. Studying the Machine Learning Lifecycle and Improving Code Quality of Machine Learning Application</li></ul><h4 id=grey-literature>Grey Literature<a hidden class=anchor aria-hidden=true href=#grey-literature>#</a></h4><h4 id=github-commit>GitHub Commit<a hidden class=anchor aria-hidden=true href=#github-commit>#</a></h4><ul><li><a href=https://github.com/tensorflow/models/commit/90f63a1e1653bfa17fde8260a4aa20231b269b7d>https://github.com/tensorflow/models/commit/90f63a1e1653bfa17fde8260a4aa20231b269b7d</a></li></ul><h4 id=stack-overflow>Stack Overflow<a hidden class=anchor aria-hidden=true href=#stack-overflow>#</a></h4><h4 id=documentation>Documentation<a hidden class=anchor aria-hidden=true href=#documentation>#</a></h4><ul><li><a href=https://pandas.pydata.org/pandas-docs/stable/user_guide/basics.html#iteration>https://pandas.pydata.org/pandas-docs/stable/user_guide/basics.html#iteration</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://hynn01.github.io/ml-smells/tags/generic/>generic</a></li><li><a href=https://hynn01.github.io/ml-smells/tags/data-cleaning/>data cleaning</a></li><li><a href=https://hynn01.github.io/ml-smells/tags/efficiency/>efficiency</a></li></ul><nav class=paginav><a class=next href=https://hynn01.github.io/ml-smells/posts/codesmells/2-nan-equivalence-comparison-misused/><span class=title>Next Page »</span><br><span>NaN Equivalence Comparison Misused</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://hynn01.github.io/ml-smells/>Code Smells for Machine Learning Applications</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>